{"ast":null,"code":"import { nanoid } from 'nanoid';\nexport default {\n  name: \"Mychat\",\n  data() {\n    return {\n      textcontent: \"\",\n      msgList: [{\n        id: nanoid(),\n        textcontent: \"\",\n        iswrite: true,\n        textcontent_length: 40,\n        gptcontent: \"\",\n        isvisual: false,\n        gptcontent_length: 40\n      }],\n      gptcontent: \"\",\n      gptcontent_in: \"\",\n      isLoading: false,\n      isStopping: false,\n      num: 0,\n      url1: \"https://pic.52112.com/2019/06/06/JPS-190606_155/24poJOgl7m_small.jpg\",\n      srcList1: [\"https://pic.52112.com/2019/06/06/JPS-190606_155/24poJOgl7m_small.jpg\"],\n      url2: \"https://tse3-mm.cn.bing.net/th/id/OIP-C.AuUr7Z3dlFHWosesrTzFiQHaHa?pid=ImgDet&rs=1\",\n      srcList2: [\"https://tse3-mm.cn.bing.net/th/id/OIP-C.AuUr7Z3dlFHWosesrTzFiQHaHa?pid=ImgDet&rs=1\"]\n    };\n  },\n  methods: {\n    getext(id) {\n      console.log('11');\n      for (let i = 0; i <= this.msgList.length; i++) {\n        if (this.msgList[i].id === id) {\n          this.msgList[i].isvisual = true;\n          break;\n        }\n      }\n    },\n    async geText() {\n      console.log('您正在向chatgpt发送内容...');\n      let num = 0;\n      await this.$ajax.get(`/test/getchat?question=${this.textcontent}&isinit=true`).then(res => {\n        console.log(res.data.data);\n        this.gptcontent = res.data.data;\n      }).catch(err => {\n        console.log(err);\n      });\n      this.isLoading = false;\n      this.isStopping = false;\n      this.interval = setInterval(() => {\n        if (!this.isStopping) {\n          this.$ajax.get(`/test/getchat?question=${this.textcontent}&isinit='false'`).then(res => {\n            this.gptcontent_in += res.data.data;\n            this.isLoading = true;\n          }).catch(err => {\n            this.isStopping = true;\n            console.log(err);\n          });\n        }\n        if (this.isLoading) {\n          const icontent = this.gptcontent_in.slice(this.num, this.num + 1);\n          if (icontent === \"*****stop*****\") {\n            clearInterval(this.interval);\n          }\n          this.gptcontent += icontent;\n          this.num++;\n        }\n      }, 100);\n    },\n    changeLen(id) {\n      for (let i = 0; i <= this.msgList.length; i++) {\n        if (this.msgList[i].id === id) {\n          const textcontent = this.msgList[i].textcontent;\n          let pattern = new RegExp(\"[\\u4E00-\\u9FA5]+\");\n          let l = 40;\n          for (let i = 0; i <= textcontent.length; i++) {\n            l += (pattern.test(textcontent.slice(i, i + 1)) ? 2 : 1) * 10;\n          }\n          this.msgList[i].textcontent_length = l;\n          console.log(this.msgList[i].textcontent_length);\n          break;\n        }\n      }\n    }\n  },\n  computed: {\n    textcontent_length() {\n      let pattern = new RegExp(\"[\\u4E00-\\u9FA5]+\");\n      let l = 40;\n      for (let i = 0; i < this.textcontent.length; i++) {\n        l += (pattern.test(this.textcontent.slice(i, i + 1)) ? 2 : 1) * 10;\n      }\n      return l;\n    }\n  }\n};","map":{"version":3,"names":["nanoid","name","data","textcontent","msgList","id","iswrite","textcontent_length","gptcontent","isvisual","gptcontent_length","gptcontent_in","isLoading","isStopping","num","url1","srcList1","url2","srcList2","methods","getext","console","log","i","length","geText","$ajax","get","then","res","catch","err","interval","setInterval","icontent","slice","clearInterval","changeLen","pattern","RegExp","l","test","computed"],"sources":["src/components/Mychat.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <h1>Mychat</h1>\r\n        <el-container style=\"margin-left: 100px;width:1400px;position: relative;\">\r\n            <el-aside style=\"height:8=1000px;background-color: rgb(255, 255, 255);overflow: hidden;\">\r\n                <el-menu\r\n                    default-active=\"1\"\r\n                    class=\"el-menu-vertical-demo\"\r\n                    background-color=\"#545c64\"\r\n                    text-color=\"#fff\"\r\n                    active-text-color=\"#ffd04b\"\r\n                    style=\"width:99%;height:800px;\">\r\n                    <el-menu-item index=\"1\" class=\"el-menu-item\">\r\n                        <i class=\"el-icon-zoom-in\" style=\"font-size: 30px;\"></i>\r\n                        <span slot=\"title\"\"> 功能1</span>\r\n                    </el-menu-item>\r\n\r\n                    <el-menu-item index=\"2\" class=\"el-menu-item\">\r\n                        <i class=\"el-icon-menu\" style=\"font-size: 30px;\"></i>\r\n                        <span slot=\"title\"> 功能2</span>\r\n                    </el-menu-item>\r\n\r\n                    <el-menu-item index=\"3\" class=\"el-menu-item\">\r\n                        <i class=\"el-icon-document\" style=\"font-size: 30px;\"></i>\r\n                        <span slot=\"title\"> 功能3</span>\r\n                    </el-menu-item>\r\n\r\n                    <el-menu-item index=\"4\" class=\"el-menu-item\">\r\n                        <i class=\"el-icon-setting\" style=\"font-size: 30px;\"></i>\r\n                        <span slot=\"title\"> 功能4</span>\r\n                    </el-menu-item>\r\n                </el-menu>\r\n            </el-aside>\r\n            <el-main style=\"padding:0px;padding-left:20px;height:800px;\r\n            background-color: rgb(248, 255, 228);display: inline-block;\" class=\"maincontent\" >\r\n            <div v-for=\"value in msgList\" :key=\"value.id\">\r\n                <el-row style=\"margin-bottom: 20px;\">\r\n                    <el-image\r\n                    style = \"width:100px;height:100px;border-radius: 10px;vertical-align: middle;\"\r\n                    :src = \"url1\"\r\n                    :preview-src-list = \"srcList1\">\r\n                    </el-image>\r\n                    <div\r\n                    style=\"border-top:15px solid transparent;\r\n                    border-bottom:15px solid transparent;\r\n                    border-left:15px solid transparent;\r\n                    border-right:15px solid rgb(226, 231, 234);\r\n                    width:0px;height:0px;vertical-align: middle;\r\n                    margin-left:0px;display: inline-block;\r\n                    \"></div>\r\n                    <input type=\"text\" @input=\"changeLen(value.id)\"  :style=\"`display: inline-block;vertical-align: middle;\r\n                    height:100px;font-size: 20px;border:0px;background-color: rgb(226, 231, 234) ;\r\n                    width:${value.textcontent_length}px;padding-left:20px;line-height: 100px;`\" class=\"input\" v-model=\"value.textcontent\"/>\r\n                    <el-button\r\n                    style=\"height:100px;vertical-align: middle;display: inline-block;font-size: 25px;text-align:center;\"\r\n                    icon=\"el-icon-s-promotion\" @click=\"getext(value.id)\"><div style=\"font-size: 10px;margin-top:10px;\">send</div>\r\n                    </el-button>\r\n                </el-row>\r\n\r\n                <el-row style=\"text-align: right;margin-right:20px;\" v-if=value.isvisual>\r\n                    <input type=\"text\" readonly :style=\"`display: inline-block;vertical-align: middle;\r\n                    height:100px;font-size: 20px;border:0px;background-color: rgb(226, 231, 234) ;\r\n                    width:${value.gptcontent_length}px;padding-left:20px;line-height: 100px;`\" class=\"input\" v-model=\"value.gptcontent\"/>\r\n                    <div\r\n                    style=\"border-top:15px solid transparent;\r\n                    border-bottom:15px solid transparent;\r\n                    border-right:15px solid transparent;\r\n                    border-left:15px solid rgb(226, 231, 234);\r\n                    width:0px;height:0px;vertical-align: middle;\r\n                    margin-left:0px;display: inline-block;\r\n                    \"></div>\r\n                    <el-image\r\n                    style = \"width:100px;height:100px;border-radius: 10px;vertical-align: middle;\"\r\n                    :src = \"url2\"\r\n                    :preview-src-list = \"srcList2\">\r\n                    </el-image>\r\n                </el-row>\r\n            </div>\r\n\r\n                \r\n            </el-main>\r\n        </el-container>\r\n    </div>\r\n</template>\r\n<script>\r\nimport {nanoid} from 'nanoid'\r\n\r\nexport default {\r\n    name : \"Mychat\",\r\n    data(){\r\n        return {\r\n            textcontent:\"\",\r\n            msgList:[{id:nanoid(),textcontent:\"\",iswrite:true,textcontent_length:40,gptcontent:\"\",isvisual:false,gptcontent_length:40}],\r\n            gptcontent:\"\",\r\n            gptcontent_in:\"\",\r\n            isLoading:false,\r\n            isStopping:false,\r\n            num:0,\r\n            url1 : \"https://pic.52112.com/2019/06/06/JPS-190606_155/24poJOgl7m_small.jpg\",\r\n            srcList1 : [\"https://pic.52112.com/2019/06/06/JPS-190606_155/24poJOgl7m_small.jpg\"],\r\n            url2 : \"https://tse3-mm.cn.bing.net/th/id/OIP-C.AuUr7Z3dlFHWosesrTzFiQHaHa?pid=ImgDet&rs=1\",\r\n            srcList2 : [\"https://tse3-mm.cn.bing.net/th/id/OIP-C.AuUr7Z3dlFHWosesrTzFiQHaHa?pid=ImgDet&rs=1\"],\r\n        }\r\n    },\r\n    methods:{\r\n        getext(id){\r\n            console.log('11')\r\n            for(let i=0;i<=this.msgList.length;i++){\r\n                if(this.msgList[i].id === id){\r\n                    this.msgList[i].isvisual = true;\r\n                    break;\r\n                }\r\n            }\r\n        },\r\n\r\n        async geText(){\r\n            console.log('您正在向chatgpt发送内容...');\r\n            let num = 0;\r\n            await this.$ajax\r\n            .get(`/test/getchat?question=${this.textcontent}&isinit=true`)\r\n            .then(res=>{\r\n                console.log(res.data.data);\r\n                this.gptcontent = res.data.data;\r\n            })\r\n            .catch(err=>{\r\n                console.log(err);\r\n            })\r\n            this.isLoading = false;\r\n            this.isStopping = false;\r\n            this.interval = setInterval(() => {\r\n                if(!this.isStopping){\r\n                    this.$ajax\r\n                    .get(`/test/getchat?question=${this.textcontent}&isinit='false'`)\r\n                    .then(res=>{\r\n                        this.gptcontent_in+=res.data.data;\r\n                        this.isLoading = true;\r\n                    })\r\n                    .catch(err=>{\r\n                        this.isStopping = true;\r\n                        console.log(err);\r\n                    })\r\n                }\r\n\r\n                if(this.isLoading){\r\n                    const icontent=this.gptcontent_in.slice(this.num,this.num+1);\r\n                    if(icontent ===  \"*****stop*****\"){\r\n                        clearInterval(this.interval)\r\n                    }\r\n                    this.gptcontent+=icontent;\r\n                    this.num ++;\r\n                }\r\n\r\n            }, 100);\r\n\r\n        },\r\n        \r\n        changeLen(id){\r\n            for(let i=0;i<=this.msgList.length;i++){\r\n                if(this.msgList[i].id === id){\r\n                    const textcontent = this.msgList[i].textcontent\r\n                    let pattern = new RegExp(\"[\\u4E00-\\u9FA5]+\");\r\n                    let l = 40;\r\n                    for(let i=0;i <= textcontent.length;i++){\r\n                        l += (pattern.test(textcontent.slice(i,i+1)) ?2:1)*10;\r\n                    }\r\n                    this.msgList[i].textcontent_length = l;\r\n                    console.log(this.msgList[i].textcontent_length)\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    },\r\n    computed:{\r\n        textcontent_length(){\r\n            let pattern = new RegExp(\"[\\u4E00-\\u9FA5]+\");\r\n            let l = 40;\r\n            for(let i=0;i < this.textcontent.length;i++){\r\n                l += (pattern.test(this.textcontent.slice(i,i+1)) ?2:1)*10;\r\n            }\r\n            return l;\r\n        }\r\n    }\r\n}\r\n</script>\r\n<style lang=\"css\" scoped>\r\n    .el-menu-vertical-demo{\r\n        text-align: center;\r\n        line-height: 200px;\r\n    }\r\n    .el-menu-item{\r\n        height: 200px;\r\n        line-height: 200px;\r\n        font-size: 20px;\r\n    }\r\n    .el-menu-item:focus{\r\n        font-size:30px;\r\n        background-color: rgb(13, 157, 59);\r\n    }\r\n    .input:focus{\r\n        outline: none;\r\n    }\r\n    .maincontent{\r\n        padding:  8px;\r\n        width: 300px;\r\n        height: 500px;\r\n        overflow: auto;\r\n    }\r\n</style>"],"mappings":"AAqFA,SAAAA,MAAA;AAEA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,WAAA;MACAC,OAAA;QAAAC,EAAA,EAAAL,MAAA;QAAAG,WAAA;QAAAG,OAAA;QAAAC,kBAAA;QAAAC,UAAA;QAAAC,QAAA;QAAAC,iBAAA;MAAA;MACAF,UAAA;MACAG,aAAA;MACAC,SAAA;MACAC,UAAA;MACAC,GAAA;MACAC,IAAA;MACAC,QAAA;MACAC,IAAA;MACAC,QAAA;IACA;EACA;EACAC,OAAA;IACAC,OAAAf,EAAA;MACAgB,OAAA,CAAAC,GAAA;MACA,SAAAC,CAAA,MAAAA,CAAA,SAAAnB,OAAA,CAAAoB,MAAA,EAAAD,CAAA;QACA,SAAAnB,OAAA,CAAAmB,CAAA,EAAAlB,EAAA,KAAAA,EAAA;UACA,KAAAD,OAAA,CAAAmB,CAAA,EAAAd,QAAA;UACA;QACA;MACA;IACA;IAEA,MAAAgB,OAAA;MACAJ,OAAA,CAAAC,GAAA;MACA,IAAAR,GAAA;MACA,WAAAY,KAAA,CACAC,GAAA,gCAAAxB,WAAA,gBACAyB,IAAA,CAAAC,GAAA;QACAR,OAAA,CAAAC,GAAA,CAAAO,GAAA,CAAA3B,IAAA,CAAAA,IAAA;QACA,KAAAM,UAAA,GAAAqB,GAAA,CAAA3B,IAAA,CAAAA,IAAA;MACA,GACA4B,KAAA,CAAAC,GAAA;QACAV,OAAA,CAAAC,GAAA,CAAAS,GAAA;MACA;MACA,KAAAnB,SAAA;MACA,KAAAC,UAAA;MACA,KAAAmB,QAAA,GAAAC,WAAA;QACA,UAAApB,UAAA;UACA,KAAAa,KAAA,CACAC,GAAA,gCAAAxB,WAAA,mBACAyB,IAAA,CAAAC,GAAA;YACA,KAAAlB,aAAA,IAAAkB,GAAA,CAAA3B,IAAA,CAAAA,IAAA;YACA,KAAAU,SAAA;UACA,GACAkB,KAAA,CAAAC,GAAA;YACA,KAAAlB,UAAA;YACAQ,OAAA,CAAAC,GAAA,CAAAS,GAAA;UACA;QACA;QAEA,SAAAnB,SAAA;UACA,MAAAsB,QAAA,QAAAvB,aAAA,CAAAwB,KAAA,MAAArB,GAAA,OAAAA,GAAA;UACA,IAAAoB,QAAA;YACAE,aAAA,MAAAJ,QAAA;UACA;UACA,KAAAxB,UAAA,IAAA0B,QAAA;UACA,KAAApB,GAAA;QACA;MAEA;IAEA;IAEAuB,UAAAhC,EAAA;MACA,SAAAkB,CAAA,MAAAA,CAAA,SAAAnB,OAAA,CAAAoB,MAAA,EAAAD,CAAA;QACA,SAAAnB,OAAA,CAAAmB,CAAA,EAAAlB,EAAA,KAAAA,EAAA;UACA,MAAAF,WAAA,QAAAC,OAAA,CAAAmB,CAAA,EAAApB,WAAA;UACA,IAAAmC,OAAA,OAAAC,MAAA;UACA,IAAAC,CAAA;UACA,SAAAjB,CAAA,MAAAA,CAAA,IAAApB,WAAA,CAAAqB,MAAA,EAAAD,CAAA;YACAiB,CAAA,KAAAF,OAAA,CAAAG,IAAA,CAAAtC,WAAA,CAAAgC,KAAA,CAAAZ,CAAA,EAAAA,CAAA;UACA;UACA,KAAAnB,OAAA,CAAAmB,CAAA,EAAAhB,kBAAA,GAAAiC,CAAA;UACAnB,OAAA,CAAAC,GAAA,MAAAlB,OAAA,CAAAmB,CAAA,EAAAhB,kBAAA;UACA;QACA;MACA;IACA;EACA;EACAmC,QAAA;IACAnC,mBAAA;MACA,IAAA+B,OAAA,OAAAC,MAAA;MACA,IAAAC,CAAA;MACA,SAAAjB,CAAA,MAAAA,CAAA,QAAApB,WAAA,CAAAqB,MAAA,EAAAD,CAAA;QACAiB,CAAA,KAAAF,OAAA,CAAAG,IAAA,MAAAtC,WAAA,CAAAgC,KAAA,CAAAZ,CAAA,EAAAA,CAAA;MACA;MACA,OAAAiB,CAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}